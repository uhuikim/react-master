# ëª©ì°¨

- ì˜ì¡´ì„±ì´ ì•„ë‹˜ì„ ì¦ëª…í•˜ê¸°
- ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„± ì œê±°í•˜ê¸°

## ì˜ì¡´ì„±ì„ ì œê±°í•˜ë ¤ë©´ ì˜ì¡´ì„±ì´ ì•„ë‹˜ì„ ì¦ëª…í•´ë¼

Effectì˜ ì˜ì¡´ì„±ì€ ì„ íƒí•  ìˆ˜ ì—†ë‹¤. Effectì˜ ì½”ë“œì— ì‚¬ìš©ë˜ëŠ” ëª¨ë“  ë°˜ì‘í˜• ê°’ì€ ì˜ì¡´ì„± ëª©ë¡ì— ì„ ì–¸ì´ ë˜ì–´ì•¼ í•œë‹¤.

1. ì»´í¬ë„ŒíŠ¸ ë°–ìœ¼ë¡œ ì´ë™ì‹œí‚¤ë©´ ë¦¬ë Œë”ë§ ì‹œì—ë„ ë³€ê²½ë˜ì§€ ì•ŠìŒì„ ì¦ëª… í•  ìˆ˜ ìˆë‹¤. 
    
    ```jsx
    const serverUrl = 'https://localhost:1234';
    const roomId = 'music';
    
    export default function ChatRoom() {
      useEffect(() => {
        const connection = createConnection(serverUrl, roomId);
        connection.connect();
        return () => connection.disconnect();
      }, []);
      return <h1>Welcome to the {roomId} room!</h1>;
    }
    ```
    
2. ì½”ë“œ ë³€ê²½í•˜ê¸°
ì˜ì¡´ì„± ì œê±° ëª©í‘œë¥¼ ì„¸ìš°ê³  ì´ ëª©í‘œì— ë§ëŠ” ì½”ë“œë¥¼ ì°¾ì•„ì•¼ í•œë‹¤.


>
>ğŸ“Œ Deep Dive
>
>ì˜ì¡´ì„± ë¦°í„°ë¥¼ ì–µì œí•˜ëŠ” ê²ƒì´ ì™œ ìœ„í—˜í•œê°€?
>
>ë²„ê·¸ê°€ ë°œìƒí–ˆì„ë•Œ ìˆ˜ì •í•˜ê¸°ê°€ ì–´ë µë‹¤.
>useEffectì— ì˜ì¡´ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ê·¸ ì•ˆì— ìˆëŠ” í•¨ìˆ˜ ë“±ì€ ëª¨ë‘ ì²˜ìŒ ìƒì„± ëì„ë•Œ(ì´ˆê¸° ë Œë”ë§ ì‹œ)ì˜ í™˜ê²½ì„ ê¸°ì–µí•œë‹¤. í•´ì„œ ì˜ë„í•œ ëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ” ë²„ê·¸ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
>

## ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„± ì œê±°í•˜ê¸°

- Effect ë¶„ë¦¬í•˜ê¸°
- setStateì‹œ ì—…ë°ì´í„° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸°
- Effect Eventì‚¬ìš©í•˜ê¸°
- ê°ì²´ë‚˜ í•¨ìˆ˜ë¥¼ ì˜ì¡´ì„±ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ë§ê¸°
- ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ë‚˜ Effect ë‚´ë¶€ë¡œ ê°’ì„ ì´ë™ì‹œí‚¤ê¸°
- ê°ì²´ì—ì„œ ì›ì‹œê°’ ì½ê¸°

ì˜ì¡´ì„± ì œê±°í•˜ê¸°ì— ì•ì„œ ì´ ì½”ë“œê°€ Effectì— ìˆì–´ì•¼í•˜ëŠ” ì½”ë“œì¸ì§€ ìƒê°í•´ë³´ì. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼í•˜ëŠ” ì½”ë“œë¼ë©´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ì‘ì„±ì„ í•˜ì.

### Effect ë¶„ë¦¬í•˜ê¸°

ê° EffectëŠ” ë…ë¦½ì ì¸ ë™ê¸°í™” í”„ë¡œì„¸ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ì•¼í•œë‹¤.

Effectê°€ ì„œë¡œ ê´€ë ¨ì´ ì—†ëŠ” ì—¬ëŸ¬ê°€ì§€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì.

```jsx
useEffect(() => {
    let ignore = false;
    fetch(`/api/cities?country=${country}`)
      .then(response => response.json())
      .then(json => {
        if (!ignore) {
          setCities(json);
        }
      });
    // ğŸ”´ Avoid: A single Effect synchronizes two independent processes
    if (city) {
      fetch(`/api/areas?city=${city}`)
        .then(response => response.json())
        .then(json => {
          if (!ignore) {
            setAreas(json);
          }
        });
    }
    return () => {
      ignore = true;
    };
  }, [country, city]); // âœ… All dependencies declared
```

1. `country`Â propsë¥¼ ê¸°ë°˜ìœ¼ë¡œÂ `cities`Â stateë¥¼ ë„¤íŠ¸ì›Œí¬ì— ë™ê¸°í™”
2. `city`Â stateë¥¼ ê¸°ë°˜ìœ¼ë¡œÂ `areas`Â stateë¥¼ ë„¤íŠ¸ì›Œí¬ì— ë™ê¸°í™”

ì„œë¡œ ê´€ë ¨ì´ ì—†ëŠ” ë‘ê°€ì§€ë¥¼ í•˜ë‚˜ì˜ Effectì—ì„œ ë™ê¸°í™”í•˜ê³  ìˆë‹¤. 

Effectë¥¼ ë¶„ë¦¬í•˜ì

```jsx
useEffect(() => {
    let ignore = false;
    fetch(`/api/cities?country=${country}`)
      .then(response => response.json())
      .then(json => {
        if (!ignore) {
          setCities(json);
        }
      });
    return () => {
      ignore = true;
    };
  }, [country]); // âœ… All dependencies declared

useEffect(() => {
    if (city) {
      let ignore = false;
      fetch(`/api/areas?city=${city}`)
        .then(response => response.json())
        .then(json => {
          if (!ignore) {
            setAreas(json);
          }
        });
      return () => {
        ignore = true;
      };
    }
  }, [city]); // âœ… All dependencies declared
```

ëª©ì ì— ë”°ë¼ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ ê°œë³„ Effectì— ê°œë³„ ì˜ì¡´ì„± ëª©ë¡ì´ ìˆì–´ ì„œë¡œê°€ ì„œë¡œë¥¼ ì´‰ë°œí•˜ì§€ ì•ŠëŠ”ë‹¤. ì½”ë“œ ì¤‘ë³µì´ ê±±ì •ëœë‹¤ë©´ ë°˜ë³µë˜ëŠ” ë¡œì§ì„ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.

### setStateì‹œ ì—…ë°ì´í„° í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

```jsx
const [messages, setMessages] = useState([]);
  useEffect(() => {
    const connection = createConnection();
    connection.connect();
    connection.on('message', (receivedMessage) => {
      setMessages([...messages, receivedMessage]);
    });
    return () => connection.disconnect();
  }, [roomId, messages]); // âœ… All dependencies declared
```

Effectì—ì„œ stateê°’ì„ ì˜ì¡´ì„±ì— ë„£ì–´ì£¼ê³  ìˆë‹¤. ìœ„ì™€ ê°™ì´ ì‘ì„±í•˜ë©´ ìƒˆ ë©”ì„¸ì§€ê°€ ì˜¬ë•Œ ë§ˆë‹¤ ì±„íŒ…ì´ ë‹¤ì‹œ ì—°ê²°ì´ ë  ê²ƒì´ë‹¤.

```jsx
const [messages, setMessages] = useState([]);
  useEffect(() => {
    const connection = createConnection();
    connection.connect();
    connection.on('message', (receivedMessage) => {
      setMessages(msgs => [...msgs, receivedMessage]);
    });
    return () => connection.disconnect();
  }, [roomId]); // âœ… All dependencies declared
```

ì—…ë°ì´í„° í•¨ìˆ˜ë¡œ ë³€ê²½í•´ì£¼ì

### Effect Eventì‚¬ìš©í•˜ê¸°

- ë°˜ì‘í˜• ì½”ë“œì™€ ë¹„ ë°˜ì‘í˜• ì½”ë“œ ë¶„ë¦¬
- propsë¡œ ë°›ëŠ” ê°’ ê°ì‹¸ì£¼ê¸°
    - ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ propìœ¼ë¡œ ë§¤ë²ˆ ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ë„˜ê²¨ì¤€ë‹¤. ì´ í•¨ìˆ˜ë¥¼ useEffect ë‚´ë¶€ì—ì„œ ì‚¬ìš©ì‹œ ì˜ì¡´ì„±ìœ¼ë¡œ ë„£ì–´ì¤˜ì•¼í•œë‹¤. ë¶€ëª¨ê°€ ë¦¬ë Œë”ë§ì´ ë  ë•Œ ë§ˆë‹¤ Effectê°€ ë‹¤ì‹œ ë™ê¸°í™”ê°€ ì¼ì–´ë‚  ê²ƒì´ë‹¤. Effect Eventë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ì‹¸ì£¼ëŠ” ë°©ë²•ì´ ìˆë‹¤.
    

### ê°ì²´ë‚˜ í•¨ìˆ˜ë¥¼ ì˜ì¡´ì„±ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ë§ê¸°

```jsx
function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  const options = {
    serverUrl: serverUrl,
    roomId: roomId
  };

  useEffect(() => {
    const connection = createConnection(options);
    connection.connect();
    return () => connection.disconnect();
  }, [options]);

  return (
    <>
      <h1>Welcome to the {roomId} room!</h1>
      <input value={message} onChange={e => setMessage(e.target.value)} />
    </>
  );
}
```

- options ê°ì²´ëŠ” ì»´í¬ë„ŒíŠ¸ ë³¸ë¬¸ì—ì„œ ì„ ì–¸ë˜ë¯€ë¡œ ë°˜ì‘í˜• ê°’ì´ë‹¤. ì˜ì¡´ì„±ìœ¼ë¡œ ì„ ì–¸í•¨
- inputì— ê°’ì„ ì…ë ¥í•˜ë©´ ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ì´ ëœë‹¤. ë¦¬ ë Œë”ë§ì‹œ ì½”ë“œëŠ” ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹¤í–‰ë¨
- options ê°ì²´ëŠ” ìƒˆë¡­ê²Œ ìƒì„±ë¨
- ë‹¤ì‹œ ë™ê¸°í™”ê°€ ì¼ì–´ë‚¨

### ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ë‚˜ Effect ë‚´ë¶€ë¡œ ê°’ì„ ì´ë™ì‹œí‚¤ê¸°

- ê°ì²´ë‚˜ í•¨ìˆ˜ë¥¼ ì™¸ë¶€ë¡œ ì´ë™ì‹œí‚¤ê¸°

```jsx
const options = {
  serverUrl: 'https://localhost:1234',
  roomId: 'music'
};

//function createOptions() {
//  return {
//    serverUrl: 'https://localhost:1234',
//    roomId: 'music'
//  };
//}

function ChatRoom() {
  const [message, setMessage] = useState('');

  useEffect(() => {
		// const options = createOptions()
    const connection = createConnection(options);
    connection.connect();
    return () => connection.disconnect();
  }, []); // âœ… All dependencies declared
```

- Effect ë‚´ë¶€ë¡œ ì´ë™ì‹œí‚¤ê¸°

```jsx
const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId
    };
    const connection = createConnection(options);
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]); // âœ… All dependencies declared
  // ...
```

Effect ë‚´ë¶€ì—ì„œ ì„ ì–¸ëœ ê°’ì€ Effectì˜ ì˜ì¡´ì„±ì´ ì•„ë‹ˆë‹¤.

### ê°ì²´&í•¨ìˆ˜ì—ì„œ ì›ì‹œê°’ ì½ê¸°

propsì—ì„œ ê°ì²´ë¥¼ ë°›ì„ ë•Œê°€ ìˆë‹¤. ë Œë”ë§ ì¤‘ì— ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°ì²´ë¥¼ ìƒì„±í•´ì¤„ ê²½ìš° ìœ„í—˜í•˜ë‹¤. Effect ì™¸ë¶€ì—ì„œ ê°ì²´ ì •ë³´ë¥¼ ì½ê³  ê°ì²´ ë° í•¨ìˆ˜ ì˜ì¡´ì„±ì„ í”¼í•˜ì

```jsx
function ChatRoom({ options }) {
  const [message, setMessage] = useState('');

// Effect ì™¸ë¶€ì—ì„œ ê°ì²´ê°’ì„ ì½ì–´ì˜¨ë‹¤.
  const { roomId, serverUrl } = options;
  useEffect(() => {
		// ìƒˆë¡­ê²Œ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
    const connection = createConnection({
      roomId: roomId,
      serverUrl: serverUrl
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId, serverUrl]); // âœ… All dependencies declared
  // ...
```

ë¡œì§ì´ ë°˜ë³µì ì´ì§€ë§Œ, ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì˜í•´ ì˜ë„ì¹˜ ì•Šê²Œ ê°ì²´ê°€ ë‹¤ì‹œ ìƒì„±ëœ ê²½ìš° ì±„íŒ…ì´ ë‹¤ì‹œ ì—°ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤.